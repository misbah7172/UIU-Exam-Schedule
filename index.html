<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exam Schedule - Final Exam Scheduler</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
    <link rel="stylesheet" href="styles.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#FF6B35',
                        secondary: '#FF8E53',
                        accent: '#F7931E',
                        'orange-gradient-start': '#FF6B35',
                        'orange-gradient-end': '#FF8E53',
                    },
                    backgroundImage: {
                        'gradient-orange': 'linear-gradient(135deg, #FF6B35 0%, #FF8E53 50%, #F7931E 100%)',
                        'gradient-orange-light': 'linear-gradient(135deg, #FFF4E6 0%, #FFE4CC 100%)',
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-gradient-orange-light min-h-screen">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8">
        <!-- Header -->
        <div class="text-center mb-6 sm:mb-8">
            <h1 class="text-3xl sm:text-4xl lg:text-5xl font-bold bg-gradient-orange bg-clip-text text-transparent mb-2">UIU Exam Schedule</h1>
            <p class="text-gray-700 text-sm sm:text-base">Upload your Excel file to view and manage exam schedules</p>
        </div>

        <!-- File Upload Section -->
        <div class="bg-white rounded-xl shadow-lg p-4 sm:p-6 mb-6 sm:mb-8 border border-orange-200">
            <div class="flex flex-col items-center">
                <div class="w-full max-w-md">
                    <label for="excelFile" class="block text-sm font-medium text-gray-700 mb-2">
                        Upload Excel File (.xlsx)
                    </label>
                    <input 
                        type="file" 
                        id="excelFile" 
                        accept=".xlsx,.xls"
                        class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition duration-200"
                    >
                </div>
                <button 
                    id="uploadBtn" 
                    class="mt-4 bg-gradient-orange hover:opacity-90 text-white font-medium py-2 px-6 rounded-lg transition duration-200 disabled:opacity-50 disabled:cursor-not-allowed shadow-md"
                    disabled
                >
                    Parse Excel File
                </button>
            </div>
        </div>

        <!-- Error Message -->
        <div id="errorMessage" class="hidden bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-4 shadow-sm">
            <span id="errorText"></span>
        </div>

        <!-- Success Message -->
        <div id="successMessage" class="hidden bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg mb-4 shadow-sm">
            <span id="successText"></span>
        </div>

        <!-- Student ID Section -->
        <div id="studentIdSection" class="hidden bg-white rounded-xl shadow-lg p-4 sm:p-6 mb-4 sm:mb-6 border border-orange-200">
            <div class="mb-4">
                <h3 class="text-lg sm:text-xl font-semibold bg-gradient-orange bg-clip-text text-transparent mb-2">Student Information</h3>
                <p class="text-xs sm:text-sm text-gray-600">Enter your student ID first, then add courses with their specific sections</p>
            </div>
            
            <div class="flex flex-col sm:flex-row gap-4 mb-4">
                <div class="flex-1">
                    <label for="studentId" class="block text-sm font-medium text-gray-700 mb-2">Student ID</label>
                    <input 
                        type="text" 
                        id="studentId" 
                        placeholder="Enter your Student ID (e.g., 011221373)"
                        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition duration-200"
                    >
                </div>
                <div class="flex items-end">
                    <button id="confirmStudentIdBtn" class="bg-gradient-orange hover:opacity-90 text-white font-medium py-2 px-4 sm:px-6 rounded-lg transition duration-200 disabled:opacity-50 disabled:cursor-not-allowed shadow-md w-full sm:w-auto" disabled>
                        Confirm Student ID
                    </button>
                </div>
            </div>
            
            <div class="text-xs text-gray-500 mt-2 p-3 bg-orange-50 rounded-lg border border-orange-100">
                <p><strong>How it works:</strong> First enter your student ID, then add courses with their specific sections. Each course can have a different section, and the room will be auto-assigned based on your ID range + the section for that specific course.</p>
            </div>
        </div>

        <!-- Course Search Section -->
        <div id="searchSection" class="hidden bg-white rounded-xl shadow-lg p-4 sm:p-6 mb-4 sm:mb-6 border border-orange-200">
            <div class="mb-4">
                <h3 class="text-lg sm:text-xl font-semibold bg-gradient-orange bg-clip-text text-transparent mb-2">Add Courses with Sections</h3>
                <p class="text-xs sm:text-sm text-gray-600">Search for courses by name, code, or title and specify the section for each course</p>
                <div class="text-xs text-gray-500 mt-2 p-2 bg-blue-50 rounded-lg border border-blue-100">
                    <p><strong>Search Tips:</strong> You can search by course code (e.g., "CSE251"), course title (e.g., "Computer Science"), or partial names (e.g., "Micro" for Microeconomics).</p>
                </div>
            </div>
            
            <div class="flex flex-col gap-4 mb-4">
                <div class="flex flex-col lg:flex-row gap-4">
                    <div class="flex-1 relative">
                        <label for="courseSearch" class="block text-sm font-medium text-gray-700 mb-2">Course Search (Name/Code/Title)</label>
                        <input 
                            type="text" 
                            id="courseSearch" 
                            placeholder="Type course name, code, or title (e.g., Micro, CSE251, Computer Science...)"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition duration-200"
                        >
                        <div id="searchSuggestions" class="absolute z-10 w-full bg-white border border-gray-300 rounded-lg shadow-lg mt-1 max-h-48 overflow-y-auto hidden"></div>
                    </div>
                    <div class="flex-1">
                        <label for="courseSection" class="block text-sm font-medium text-gray-700 mb-2">Section</label>
                        <select 
                            id="courseSection" 
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition duration-200"
                            disabled
                        >
                            <option value="">Select a course first</option>
                        </select>
                    </div>
                </div>
                <div class="flex justify-end">
                    <button id="addCourseBtn" class="bg-gradient-orange hover:opacity-90 text-white font-medium py-2 px-4 sm:px-6 rounded-lg transition duration-200 disabled:opacity-50 disabled:cursor-not-allowed shadow-md w-full sm:w-auto" disabled>
                        Add Course with Section
                    </button>
                </div>
            </div>
            
            <!-- Selected Courses -->
            <div id="selectedCoursesSection" class="hidden">
                <h4 class="text-md font-medium text-gray-700 mb-3">Your Selected Courses:</h4>
                <div id="selectedCourses" class="space-y-2 mb-4"></div>
                <div class="flex flex-col sm:flex-row gap-2">
                    <button id="clearSelectedBtn" class="bg-red-500 hover:bg-red-600 text-white font-medium py-2 px-4 rounded-lg transition duration-200 shadow-md">
                        Clear Selected
                    </button>
                    <button id="downloadTimetableBtn" class="bg-gradient-orange hover:opacity-90 text-white font-medium py-2 px-4 rounded-lg transition duration-200 shadow-md">
                        Download PDF
                    </button>
                </div>
            </div>
        </div>

        <!-- Controls -->
        <div id="controls" class="hidden bg-white rounded-xl shadow-lg p-4 sm:p-6 mb-4 sm:mb-6 border border-orange-200">
            <div class="flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between">
                <div class="flex flex-col sm:flex-row flex-wrap gap-4 items-start sm:items-center">
                    <div class="flex flex-col sm:flex-row items-start sm:items-center gap-2">
                        <label for="sortBy" class="text-sm font-medium text-gray-700 whitespace-nowrap">Sort by:</label>
                        <select id="sortBy" class="px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary transition duration-200">
                            <option value="course">Course Name</option>
                            <option value="date">Date</option>
                            <option value="time">Time</option>
                            <option value="room">Room</option>
                        </select>
                    </div>
                    <div class="flex flex-col sm:flex-row items-start sm:items-center gap-2">
                        <label for="sortOrder" class="text-sm font-medium text-gray-700 whitespace-nowrap">Order:</label>
                        <select id="sortOrder" class="px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary transition duration-200">
                            <option value="asc">Ascending</option>
                            <option value="desc">Descending</option>
                        </select>
                    </div>
                    <button id="clearBtn" class="bg-gray-500 hover:bg-gray-600 text-white font-medium py-2 px-4 rounded-lg transition duration-200 shadow-md">
                        Clear Data
                    </button>
                </div>
                <div class="flex gap-2 w-full lg:w-auto">
                    <button id="toggleRoutineBtn" class="bg-gradient-orange hover:opacity-90 text-white font-medium py-2 px-4 rounded-lg transition duration-200 shadow-md flex-1 lg:flex-none">
                        Show Full Routine
                    </button>
                </div>
            </div>
        </div>

        <!-- Table Container -->
        <div id="tableContainer" class="hidden">
            <div class="bg-white rounded-xl shadow-lg overflow-hidden border border-orange-200">
                <div class="px-4 sm:px-6 py-4 border-b border-gray-200 bg-gradient-orange">
                    <h2 class="text-lg sm:text-xl font-semibold text-white">Exam Schedule Data</h2>
                    <p class="text-sm text-orange-100 mt-1">Total exams: <span id="examCount">0</span></p>
                </div>
                
                <!-- Responsive Table -->
                <div class="overflow-x-auto">
                    <table id="examTable" class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-orange-50">
                            <tr>
                                <th class="px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider cursor-pointer hover:bg-orange-100 transition duration-200" data-sort="course">
                                    Course Name
                                    <span class="sort-indicator ml-1">↕</span>
                                </th>
                                <th class="px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider cursor-pointer hover:bg-orange-100 transition duration-200" data-sort="date">
                                    Date
                                    <span class="sort-indicator ml-1">↕</span>
                                </th>
                                <th class="px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider cursor-pointer hover:bg-orange-100 transition duration-200" data-sort="time">
                                    Time
                                    <span class="sort-indicator ml-1">↕</span>
                                </th>
                                <th class="px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider cursor-pointer hover:bg-orange-100 transition duration-200" data-sort="room">
                                    Room
                                    <span class="sort-indicator ml-1">↕</span>
                                </th>
                            </tr>
                        </thead>
                        <tbody id="examTableBody" class="bg-white divide-y divide-gray-200">
                            <!-- Data will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Loading indicator -->
        <div id="loading" class="hidden text-center py-8">
            <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary"></div>
            <p class="mt-2 text-gray-700">Processing file...</p>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
